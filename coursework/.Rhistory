x$homeF[2,3]
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
HomeF = paste0(round(x$homeF[2,3],3)," [",x$homeF[2,2],", ",x$homeF[2,1],"]"),
)
}
get_gof(x)
paste0(round(x$homeF[2,3],3)," [",x$homeF[2,2],", ",x$homeF[2,1],"]")
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
HomeF = paste0(round(x$homeF[2,3],3)," [",x$homeF[2,2],", ",x$homeF[2,1],"]")
)
}
get_gof(x)
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
HomeF = paste0(round(x$homeF[2,3],3)," [",x$homeF[2,2],",",x$homeF[2,1],"]")
)
}
msummary(twfe_total,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
gen_stars <- function(p){
if (p<0.001){
return("***")
} else if (p<0.01){
return("**")
} else if (p<0.05){
return("*")
} else if (p<0.1){
return("+")
} else {
return("")
}
}
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
HomeF = paste0(round(x$homeF[2,3],3),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]")
)
}
msummary(twfe_total,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL)
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3)
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="Year FE", "clean" = "Year FE", "fmt" = NULL))
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]")
)
}
x$foreignF
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(is.na(x$foreignF)){
NA
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="Year FE", "clean" = "Year FE", "fmt" = NULL))
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(is.na(x$foreignF)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="Year FE", "clean" = "Year FE", "fmt" = NULL))
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
get_gof(twfe_total[[1]])
get_gof(twfe_total[[2]])
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
x <- twfe_total[[2]]
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
x <- twfe_total[[3]]
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
for (i in (1:8)) print(twfe_total[[i]]$foreignF)
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(is.na(x$foreignF)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="Year FE", "clean" = "Year FE", "fmt" = NULL))
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
if(is.na(x$foreignF)) print("a")
x$foreignF
if(is.null(x$foreignF)) print("a")
if(is.null(NA)) print("a")
if(is.null(NA)) print("a")
if(is.na(NA)) print("a")
anyNA(NA)
if(anyNA(x$foreignF)) print("a")
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(anyNA(x$foreignF)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(anyNA(x$foreignF)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
twfe_total[[1]]$homeF==NA
twfe_total[[2]]$homeF==NA
twfe_total[[3]]$ForeignF==NA
twfe_total[[1]]$ForeignF==NA
twfe_total[[2]]$ForeignF==NA
twfe_total[[3]]$ForeignF==NA
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="YearFE", "clean" = "Year FE", "fmt" = NULL))
exists(twfe_total[[3]]$ForeignF)
exists(twfe_total[[3]]$ForeignF)
twfe_total[[3]]$ForeignF
twfe_total <- list(reg_total_attack_none, reg_total_attack_control,
reg_total_attack_geo, reg_total_attack_cul,
reg_total_casualty_none, reg_total_casualty_control,
reg_total_casualty_geo, reg_total_casualty_cul)
for (i in 1:length(twfe_total)){
twfe_total[[i]]$df.residual <- parameters::degrees_of_freedom(twfe_total[[i]])
home <- names(coef(twfe_total[[i]]))[grepl("Home",names(coef(twfe_total[[i]])))]
twfe_total[[i]]$homeF <- lht(twfe_total[[i]],test='F',
c(paste0(home,"=0")))
foreign <- character()
foreign <- names(coef(twfe_total[[i]]))[grepl("geo|cul",names(coef(twfe_total[[i]])))]
if (length(foreign)>0){
twfe_total[[i]]$foreignF <- lht(twfe_total[[i]],test='F',
c(paste0(foreign,"=0"))
)
}
}
names(x)
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if("ForeignF" %in% names(x)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="YearFE", "clean" = "Year FE", "fmt" = NULL))
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
names(twfe_total[[1]])
"ForeignF" %in% names(twfe_total[[1]])
"ForeignF" %in% names(twfe_total[[2]])
"ForeignF" %in% names(twfe_total[[3]])
"ForeignF" %in% names(twfe_total[[4]])
for (i in 1:length(twfe_total)){
twfe_total[[i]]$df.residual <- parameters::degrees_of_freedom(twfe_total[[i]])
home <- names(coef(twfe_total[[i]]))[grepl("Home",names(coef(twfe_total[[i]])))]
twfe_total[[i]]$homeF <- lht(twfe_total[[i]],test='F',
c(paste0(home,"=0")))
foreign <- character()
foreign <- names(coef(twfe_total[[i]]))[grepl("geo|cul",names(coef(twfe_total[[i]])))]
if (length(foreign)>0){
twfe_total[[i]]$foreignF <- lht(twfe_total[[i]],test='F',
c(paste0(foreign,"=0"))
)
}
}
"ForeignF" %in% names(twfe_total[[4]])
names(twfe_total[[4]])
glance_custom.fixest <- function(x, ...) {
data.frame(
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(!"foreignF" %in% names(x)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
gof_map <- list(list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="YearFE", "clean" = "Year FE", "fmt" = NULL))
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
sum(is.na(data$geoAttacksY1))
sum(is.na(data$geoAttacksY2))
sum(is.na(data$geoAttacksY3))
coef(reg_total_attack_control)
glance_custom.fixest <- function(x, ...) {
data.frame(
"controls" = ifelse("GrowthY1" %in% names(coef(x)),
"Yes","No"),
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(!"foreignF" %in% names(x)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
gof_map <- list(list("raw"="controls", clean="Controls", fmt=NULL),
list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="YearFE", "clean" = "Year FE", "fmt" = NULL))
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
saveRDS(msummary(twfe_total, gof_map = gof_map, output="modelsummary_list",
coef_map=coef_map, stars=T),
"output/twfe_total.rds")
a <- readRDS("output/twfe_total.rds")
View(a)
table_twfe_total <- msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
saveRDS(table_twfe_total,
"output/twfe_total.rds")
save(twfe_total, gof_map, coef_map, file="twfe_total.RData")
need <- c('tidyverse','modelsummary','haven','fixest','kableExtra') # list packages needed
have <- need %in% rownames(installed.packages()) # checks packages you have
if(any(!have)) install.packages(need[!have]) # install missing packages
invisible(lapply(need, library, character.only=T))
data <- read_dta("PopulismTerrorism.dta")
data <- as_factor(data)
table_twfe_total <- msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
table_twfe_total <- msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
table_twfe_total <- msummary(twfe_total, gof_map = gof_map, escape=F,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
table_twfe_total <- msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
table_twfe_total <- msummary(twfe_total,
#gof_map = gof_map,
#coef_map=coef_map,
stars=T) |>
kable_styling(full_width = T)
save(twfe_total, gof_map, coef_map, glance_custom.fixest, file="twfe_total.RData")
save(twfe_total, gof_map, coef_map, glance_custom.fixest,
gen_stars, file="twfe_total.RData")
reg_total_attack_geo <- feols(as.formula(paste0(outcome,homeattacks,geoattacks,fe)),data)
View(data)
#############################twfe########################################
load("cleaned/data.RData")
reg_total_attack_geo <- feols(as.formula(paste0(outcome,homeattacks,geoattacks,fe)),data)
reg_total_attack_cul <- feols(as.formula(paste0(outcome,homeattacks,culattacks,fe)),data)
reg_total_casualty_geo <- feols(as.formula(paste0(outcome,homecasualty,geoattacks,fe)),data)
reg_total_casualty_cul <- feols(as.formula(paste0(outcome,homecasualty,culattacks,fe)),data)
coef_map <- c("HomeAttacksY1"="HomeTerrorism$_{t-1}$",
"HomeAttacksY2"="HomeTerrorism$_{t-2}$",
"HomeAttacksY3"="HomeTerrorism$_{t-3}$",
"HomeAttacksY4"="HomeTerrorism$_{t-4}$",
"HomencasY1"="HomeTerrorism$_{t-1}$",
"HomencasY2"="HomeTerrorism$_{t-2}$",
"HomencasY3"="HomeTerrorism$_{t-3}$",
"HomencasY4"="HomeTerrorism$_{t-4}$",
"geoAttacksY1"="ForeignTerrorism$_{t-1}$",
"geoAttacksY2"="ForeignTerrorism$_{t-2}$",
"geoAttacksY3"="ForeignTerrorism$_{t-3}$",
"geoAttacksY4"="ForeignTerrorism$_{t-4}$",
"geoncasY1"="ForeignTerrorism$_{t-1}$",
"geoncasY2"="ForeignTerrorism$_{t-2}$",
"geoncasY3"="ForeignTerrorism$_{t-3}$",
"geoncasY4"="ForeignTerrorism$_{t-4}$",
"culAttacksY1"="ForeignTerrorism$_{t-1}$",
"culAttacksY2"="ForeignTerrorism$_{t-2}$",
"culAttacksY3"="ForeignTerrorism$_{t-3}$",
"culAttacksY4"="ForeignTerrorism$_{t-4}$",
"culncasY1"="ForeignTerrorism$_{t-1}$",
"culncasY2"="ForeignTerrorism$_{t-2}$",
"culncasY3"="ForeignTerrorism$_{t-3}$",
"culncasY4"="ForeignTerrorism$_{t-4}$")
twfe_total <- list(reg_total_attack_none, reg_total_attack_control,
reg_total_attack_geo, reg_total_attack_cul,
reg_total_casualty_none, reg_total_casualty_control,
reg_total_casualty_geo, reg_total_casualty_cul)
for (i in 1:length(twfe_total)){
twfe_total[[i]]$df.residual <- parameters::degrees_of_freedom(twfe_total[[i]])
home <- names(coef(twfe_total[[i]]))[grepl("Home",names(coef(twfe_total[[i]])))]
twfe_total[[i]]$homeF <- lht(twfe_total[[i]],test='F',
c(paste0(home,"=0")))
foreign <- character()
foreign <- names(coef(twfe_total[[i]]))[grepl("geo|cul",names(coef(twfe_total[[i]])))]
if (length(foreign)>0){
twfe_total[[i]]$foreignF <- lht(twfe_total[[i]],test='F',
c(paste0(foreign,"=0"))
)
}
}
gen_stars <- function(p){
if (p<0.001){
return("***")
} else if (p<0.01){
return("**")
} else if (p<0.05){
return("*")
} else if (p<0.1){
return("+")
} else {
return("")
}
}
glance_custom.fixest <- function(x, ...) {
data.frame(
"controls" = ifelse("GrowthY1" %in% names(coef(x)),
"Yes","No"),
'vcov.type'="Clustered",
'CountryFE' = "Yes",
'YearFE' = "Yes",
'HomeF' = paste0(round(x$homeF[2,3],2),gen_stars(x$homeF[2,4]),
" [",x$homeF[2,2],",",x$homeF[2,1],"]"),
"ForeignF" = if(!"foreignF" %in% names(x)){
""
} else {
paste0(round(x$foreignF[2,3],2),gen_stars(x$foreignF[2,4]),
" [",x$foreignF[2,2],",",x$foreignF[2,1],"]")
}
)
}
gof_map <- list(list("raw"="controls", clean="Controls", fmt=NULL),
list("raw"="HomeF", "clean" = "$F_{home}$", "fmt"=NULL),
list("raw"="ForeignF", "clean" = "$F_{foreign}$", "fmt"=NULL),
list("raw" = "nobs", "clean" = "$N$", "fmt" = 0),
list("raw" = "adj.r.squared", "clean" = "$R^2$ Adj.", "fmt" = 3),
list("raw" = "r2.within.adjusted", "clean" = "$R^2$ Within Adj.", "fmt" = 3),
list('raw' = 'vcov.type', 'clean' = 'Std.Errors', 'fmt' = NULL),
list("raw"="CountryFE", "clean" = "Country FE", "fmt" = NULL),
list("raw"="YearFE", "clean" = "Year FE", "fmt" = NULL))
#table_twfe_total <-
msummary(twfe_total, gof_map = gof_map,
coef_map=coef_map, stars=T) |>
add_header_above(c(" "=1,"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$",
"$c=0$"=2,"$c=c^{geo}$"=1,"$c=c^{cul}$")) |>
add_header_above(c(" "=1,"Total Attacks"=4,"Total Casualties"=4))
